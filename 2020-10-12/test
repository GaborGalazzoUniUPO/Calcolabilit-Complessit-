q0, , ,q1, , ,R


q1,1, ,q2,A, ,R

q2,1, ,q2,1, ,R
q2,0, ,q2,0, ,R
q2, , ,q3, , ,L
q2,1,0,q3,1,0,L
q2,1,1,q3,1,1,L
q2,0,1,q3,0,1,L
q2,0,0,q3,0,0,L

q3,1, ,q4,1,1,L
q3,0, ,q4,0,1,L

q4,1, ,q4,1, ,L
q4,0, ,q4,0, ,L

q4, , ,q1, , ,R

q1,0, ,q5,A, ,R

q5,1, ,q5,1, ,R
q5,0, ,q5,0, ,R
q6, , ,q7, , ,L
q6,1,0,q7,1,0,L
q6,1,1,q7,1,1,L
q6,0,1,q7,0,1,L
q6,0,0,q7,0,0,L

q7,1, ,q8,1,0,L
q7,0, ,q8,0,0,L

q8,1, ,q8,1, ,L
q8,0, ,q8,0, ,L

q, , ,q1, , ,R
  ----------------


q0, , ,q_iscan, , ,R

q_iscan,0, ,q_fw0,B, ,L

q_fw0,0,0,qfw_0,0,0,L
q_fw0,0,1,qfw_0,0,1,L
q_fw0,0, ,qfw_0,0, ,L
q_fw0,1,1,qfw_0,1,1,L
q_fw0,1,0,qfw_0,1,0,L
q_fw0,1, ,qfw_0,1, ,L

q_fw0, , ,q_w0, , ,R
q_w0,0, ,q_w0,0, ,R
q_w0,1, ,q_w0,1, ,R

q_w0,0,0,q_ww0,0,0,L
q_w0,0,1,q_ww0,0,1,L
q_w0,1,0,q_ww0,1,0,L
q_w0,1,1,q_ww0,1,1,L

q_ww0,1, ,q_rew,1,0,L
q_ww0,0, ,q_rew,0,0,L

q_rew,1, ,q_rew,1, ,L
q_rew,0, ,q_rew,0, ,L

q_rew, , ,q0, , ,S